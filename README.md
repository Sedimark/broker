# SEDIMARK Data Broker

The SEDIMARK Data Broker is the default store for Data Assets generated by Providers through the SEDIMARK Orchestration Tool, or pushed directly from the data source.

The Broker is also employed by the SEDIMARK Toolbox for storing Asset Descriptions created after the generation of Assets (i.e. Data, AI Models, Services etc.), as a by-product to provide metadata about the Asset.

The Broker is realised through the [Stellio Context Broker](https://github.com/stellio-hub/stellio-context-broker).



## Context
The [context](https://sedimark.github.io/broker/jsonld-contexts/sedimark-compound.jsonld) defines all properties for each type of Asset :
- [Asset](https://sedimark.github.io/broker/jsonld-contexts/sedimark-asset.jsonld) (Abstract Class. Properties common to all types)
- [DataAsset](https://sedimark.github.io/broker/jsonld-contexts/sedimark-data-asset.jsonld)
- [AIModelAsset](https://sedimark.github.io/broker/jsonld-contexts/sedimark-ai-model-asset.jsonld)
- [ServiceAsset](https://sedimark.github.io/broker/jsonld-contexts/sedimark-service-asset.jsonld)

Context for reference Use Cases: 

- [Mobility Management for Municipality Services, Helsinki](https://sedimark.github.io/broker/jsonld-contexts/sedimark-helsinki-compound.jsonld)
  - Air Quality
  - Traffic
  - Place Geometries
- [Water Quality and Environment](TBC)
  - Weather Stations
   - Hydrometric Stations
- [Urban Planning for Cycle Routes, Santander](TBC)
  - Vehicle
  - Vehicle (Bike) Stations
- [Domestic Energy Consumption and Churn](TBC)
  - Energy Consumption

## Calling the broker with the context
You can use the "Link" header to define the context of your request when calling the NGSILD-Broker.
```
<https://sedimark.github.io/broker/jsonld-contexts/sedimark-compound.jsonld>; rel="http://www.w3.org/ns/json-ld#context"; type="application/ld+json"
```

## Creation of assets
An example of asset creation for a broker deployed on "localhost:8080" would be the following :
```
POST "localhost:8080/ngsi-ld/v1/entities"
```
body : [example here](https://sedimark.github.io/broker/payload-example/asset.jsonld)

## Fetching of Asset by id
```
GET "localhost:8080/ngsi-ld/v1/entities/{id}"
```

[response example](https://sedimark.github.io/broker/payload-example/asset.jsonld)

##  Fetching of a list of Assets
```
GET "localhost:8080/ngsi-ld/v1/entities?type=Asset"
```
## Temporal entities
If your properties are changing through time, you can add an observedAt value inside the properties to mark the point that they represent in times.

Then you can use the temporal endpoints to fetch the temporal representation.
https://stellio.readthedocs.io/en/latest/API_walkthrough.html#get-temporal-evolution-of-attributes

## additionnal resource https://ngsild.org/

